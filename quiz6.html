<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz 6</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/quiz6.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/responsive_quiz.css') }}">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    <style>
        .btn.selected {
            transform: translateY(-3px) !important;
            background: linear-gradient(50deg, #DF7E7A, #B76A66, #8F5553) !important;
            border: none !important;
            color: #fff !important;
            box-shadow: 0 0 8px 2px rgba(223, 126, 122, 0.4),
                0 0 15px 4px rgba(183, 106, 102, 0.25) !important;
        }
    </style>
</head>

<body data-page="6">
    <header>
        <img src="{{ url_for('static', filename='img/skincare.png') }}" alt="">
        <hr>

        <div class="titulo">
            <h2 class="pg">Gostaria de receber sua rotina de cuidados com a pele no seu e-mail?</h2>
        </div>
    </header>

    <main class="container">
        <form>
            <div class="input-box">
                <input type="email" id="emailInput" placeholder="Email">
                <i class="bx bxs-user"></i>
            </div>

            <button id="fakeBtn" class="enviar" type="button">ENVIAR</button>
        </form>
    </main>

    <div class="bolinhas">
        <span class="bolinha1"></span>
        <span class="bolinha1"></span>
        <span class="bolinha1"></span>
        <span class="bolinha1"></span>
        <span class="bolinha1"></span>
        <span class="shadow"></span>
        <span class="empty"></span>
    </div>

    <footer class="prx">
        <a id="back" href="{{ url_for('quiz5') }}">←</a>
        <button id="nextBtn" class="btn" style="width:150px; height:40px;">próximo →</button>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", () => {

            const page = parseInt(document.body.dataset.page);
            const nextBtn = document.getElementById("nextBtn");
            const fakeBtn = document.getElementById("fakeBtn");
            const emailInput = document.getElementById("emailInput");

            fakeBtn.addEventListener("click", () => {
                alert("Seu email foi registrado com sucesso!");
            });

            nextBtn.addEventListener("click", async () => {

                const email = emailInput.value.trim();
                const choice = email ? [`Email enviado: ${email}`] : ["Não forneceu email"];

                nextBtn.disabled = true;
                nextBtn.textContent = "Enviando...";

                const resp = await fetch("/api/save_answer", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ page, choices: choice })
                });

                const data = await resp.json();
                window.location.href = data.next;
            });

        });
    </script>

</body>

</html>
